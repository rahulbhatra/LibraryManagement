#Library Management Migration Script

1. Author


    CREATE TABLE IF NOT EXISTS public.author
    (
        document_id bigint NOT NULL,
        person_id bigint NOT NULL,
        CONSTRAINT author_pkey PRIMARY KEY (document_id, person_id),
        CONSTRAINT fk6hvf724whhl6gil5s4l1jefje FOREIGN KEY (document_id)
            REFERENCES public.document (id) MATCH SIMPLE
            ON UPDATE NO ACTION
            ON DELETE NO ACTION,
        CONSTRAINT fkd8cm5fy8qunfotg4xpdi1wad7 FOREIGN KEY (person_id)
            REFERENCES public.person (id) MATCH SIMPLE
            ON UPDATE NO ACTION
            ON DELETE NO ACTION
    )

2. Book


    CREATE TABLE IF NOT EXISTS public.book
    (
        id bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 9223372036854775807 CACHE 1 ),
        category character varying(255) COLLATE pg_catalog."default",
        edition integer NOT NULL,
        isbn character varying(255) COLLATE pg_catalog."default",
        title character varying(255) COLLATE pg_catalog."default",
        year integer NOT NULL,
        book_document_id bigint,
        published_by_id bigint NOT NULL,
        CONSTRAINT book_pkey PRIMARY KEY (id),
        CONSTRAINT fk3idh6pescpo2ay9h00k3v44p6 FOREIGN KEY (published_by_id)
            REFERENCES public.publisher (id) MATCH SIMPLE
            ON UPDATE NO ACTION
            ON DELETE NO ACTION,
        CONSTRAINT fklhpe8m620k6wjulsb7ooftcna FOREIGN KEY (book_document_id)
            REFERENCES public.document (id) MATCH SIMPLE
            ON UPDATE NO ACTION
            ON DELETE NO ACTION
    )

3. BorrowReturn


    CREATE TABLE IF NOT EXISTS public.borrow_return
    (
        borrow_date timestamp without time zone NOT NULL,
        due_date timestamp without time zone,
        is_overdue boolean NOT NULL,
        return_date timestamp without time zone,
        copy_id bigint NOT NULL,
        borrowed_by_id character varying(255) COLLATE pg_catalog."default" NOT NULL,
        CONSTRAINT borrow_return_pkey PRIMARY KEY (borrow_date, borrowed_by_id, copy_id),
        CONSTRAINT fkqfve99p8atdgd6m89usu1bniy FOREIGN KEY (borrowed_by_id)
            REFERENCES public.member (id) MATCH SIMPLE
            ON UPDATE NO ACTION
            ON DELETE NO ACTION,
        CONSTRAINT fksx2o4lmqigt4ye8bxljc9cqn5 FOREIGN KEY (copy_id)
            REFERENCES public.copy (id) MATCH SIMPLE
            ON UPDATE NO ACTION
            ON DELETE NO ACTION
    )

4. Cites


    CREATE TABLE IF NOT EXISTS public.cite
    (
        cited_document_id bigint NOT NULL,
        cited_by_document_id bigint NOT NULL,
        CONSTRAINT cite_pkey PRIMARY KEY (cited_by_document_id, cited_document_id),
        CONSTRAINT fk7j75mbopn0mvle5mlkd2ns2yu FOREIGN KEY (cited_by_document_id)
            REFERENCES public.document (id) MATCH SIMPLE
            ON UPDATE NO ACTION
            ON DELETE NO ACTION,
        CONSTRAINT fktia95kpny4b2ohcxfcg2qluhw FOREIGN KEY (cited_document_id)
            REFERENCES public.document (id) MATCH SIMPLE
            ON UPDATE NO ACTION
            ON DELETE NO ACTION
    )

5. Contributor


    CREATE TABLE IF NOT EXISTS public.contributor
    (
        person_id bigint NOT NULL,
        issue_id bigint NOT NULL,
        CONSTRAINT contributor_pkey PRIMARY KEY (issue_id, person_id),
        CONSTRAINT fkgbqghqoclx6talu9gr7qkbvkj FOREIGN KEY (issue_id)
            REFERENCES public.issue (id) MATCH SIMPLE
            ON UPDATE NO ACTION
            ON DELETE NO ACTION,
        CONSTRAINT fktn4hfulld452ksv5hhf6ko3em FOREIGN KEY (person_id)
            REFERENCES public.person (id) MATCH SIMPLE
            ON UPDATE NO ACTION
            ON DELETE NO ACTION
    )

6. Copy
    
    
    CREATE TABLE IF NOT EXISTS public.copy
    (
        id bigint NOT NULL,
        level integer NOT NULL,
        room_number integer NOT NULL,
        copy_of_document_id bigint NOT NULL,
        CONSTRAINT copy_pkey PRIMARY KEY (id),
        CONSTRAINT fkk9jkpblc99592dtx5wqo6t97n FOREIGN KEY (copy_of_document_id)
            REFERENCES public.document (id) MATCH SIMPLE
            ON UPDATE NO ACTION
            ON DELETE NO ACTION
    )

7. Document
    
    
    CREATE TABLE IF NOT EXISTS public.document
    (
        id bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 9223372036854775807 CACHE 1 ),
        created_date timestamp without time zone,
        deleted_date timestamp without time zone,
        hierarchical_classification character varying(255) COLLATE pg_catalog."default",
        updated_date timestamp without time zone,
        created_by_id bigint NOT NULL,
        deleted_by_id bigint,
        updated_by_id bigint,
        CONSTRAINT document_pkey PRIMARY KEY (id),
        CONSTRAINT fkcqv87j29cw3i7hs194nsqm215 FOREIGN KEY (created_by_id)
            REFERENCES public.librarian (id) MATCH SIMPLE
            ON UPDATE NO ACTION
            ON DELETE NO ACTION,
        CONSTRAINT fkml56l8smaj4f9pldhmjo2pdi3 FOREIGN KEY (deleted_by_id)
            REFERENCES public.librarian (id) MATCH SIMPLE
            ON UPDATE NO ACTION
            ON DELETE NO ACTION,
        CONSTRAINT fkockid3p93sy6n19x42nv4ao8e FOREIGN KEY (updated_by_id)
            REFERENCES public.librarian (id) MATCH SIMPLE
            ON UPDATE NO ACTION
            ON DELETE NO ACTION
    )

8. Editor
    

    CREATE TABLE IF NOT EXISTS public.editor
    (
        person_id bigint NOT NULL,
        issue_id bigint NOT NULL,
        CONSTRAINT editor_pkey PRIMARY KEY (issue_id, person_id),
        CONSTRAINT fk89evp3s7ux51mswt97gd8gvea FOREIGN KEY (person_id)
        REFERENCES public.person (id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION,
        CONSTRAINT fkgyi8owbw0f8edtuq2t5ldk3ag FOREIGN KEY (issue_id)
        REFERENCES public.issue (id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
    )

9. Issue


    CREATE TABLE IF NOT EXISTS public.issue
    (
        id bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 9223372036854775807 CACHE 1 ),
        published_at timestamp without time zone,
        title character varying(255) COLLATE pg_catalog."default",
        published_by_id bigint,
        CONSTRAINT issue_pkey PRIMARY KEY (id),
        CONSTRAINT fktgp337s5rgo9e35k8668dt3kq FOREIGN KEY (published_by_id)
        REFERENCES public.publisher (id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
    )

10. IssuedIn

    
    CREATE TABLE IF NOT EXISTS public.issued_in
    (
        magazine_id bigint NOT NULL,
        issue_id bigint NOT NULL,
        CONSTRAINT issued_in_pkey PRIMARY KEY (issue_id, magazine_id),
        CONSTRAINT fkm989hllbs22tjpgj9bpko8iul FOREIGN KEY (issue_id)
        REFERENCES public.issue (id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION,
        CONSTRAINT fkplpk46d3m4ynn7ecoglqewtud FOREIGN KEY (magazine_id)
        REFERENCES public.magazine (id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
    )

11. Journal 

    
    CREATE TABLE IF NOT EXISTS public.journal
    (
        id bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 9223372036854775807 CACHE 1 ),
        edition integer NOT NULL,
        title character varying(255) COLLATE pg_catalog."default",
        published_by_id bigint NOT NULL,
        CONSTRAINT journal_pkey PRIMARY KEY (id),
        CONSTRAINT fk7y4d95ptdq13kmq09b0wobbdf FOREIGN KEY (published_by_id)
        REFERENCES public.publisher (id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
    )

12. JournalArticle
    
    
    CREATE TABLE IF NOT EXISTS public.journal_article
    (
        id bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 9223372036854775807 CACHE 1 ),
        title character varying(255) COLLATE pg_catalog."default",
        journal_id bigint NOT NULL,
        journal_article_document_id bigint,
        CONSTRAINT journal_article_pkey PRIMARY KEY (id),
        CONSTRAINT fkojl36oecp46pi2rswcuojh7p0 FOREIGN KEY (journal_article_document_id)
        REFERENCES public.document (id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION,
        CONSTRAINT fkq1384is12ijm8qd4x8sv756il FOREIGN KEY (journal_id)
        REFERENCES public.journal (id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
    )

13. Keyword
   
 
    CREATE TABLE IF NOT EXISTS public.keyword
    (
        keyword character varying(255) COLLATE pg_catalog."default",
        document_id bigint NOT NULL,
        CONSTRAINT keyword_pkey PRIMARY KEY (document_id),
        CONSTRAINT fk30eq5suy8g36jm1okeicd52i5 FOREIGN KEY (document_id)
        REFERENCES public.document (id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
    )

14. Librarian
    

    CREATE TABLE IF NOT EXISTS public.librarian
    (
        id bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 9223372036854775807 CACHE 1 ),
        librarian_info_id bigint,
        CONSTRAINT librarian_pkey PRIMARY KEY (id),
        CONSTRAINT fkk904j5twba0fqthl1lnelp4sf FOREIGN KEY (librarian_info_id)
        REFERENCES public.users (id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
    )
    

15. Magazine


    CREATE TABLE IF NOT EXISTS public.magazine
    (
        id bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 9223372036854775807 CACHE 1 ),
        edition integer NOT NULL,
        name character varying(255) COLLATE pg_catalog."default",
        magazine_document_id bigint,
        published_by_id bigint NOT NULL,
        CONSTRAINT magazine_pkey PRIMARY KEY (id),
        CONSTRAINT fkej3ce7a4ho4i152v52j2aqsd2 FOREIGN KEY (published_by_id)
        REFERENCES public.publisher (id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION,
        CONSTRAINT fkjv05eeshxgn5hhiw1v9nk0jie FOREIGN KEY (magazine_document_id)
        REFERENCES public.document (id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
    )

16. Member
    

    CREATE TABLE IF NOT EXISTS public.member
    (
        id character varying(255) COLLATE pg_catalog."default" NOT NULL,
        membership_coverage timestamp without time zone,
        managed_by_id bigint NOT NULL,
        member_info_id bigint,
        CONSTRAINT member_pkey PRIMARY KEY (id),
        CONSTRAINT fk5a204j32xf7ofy989ohkw88cy FOREIGN KEY (managed_by_id)
        REFERENCES public.librarian (id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION,
        CONSTRAINT fk7a20aen9jv5ekoaekd8j78pco FOREIGN KEY (member_info_id)
        REFERENCES public.users (id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
    )

17. Person
    

    CREATE TABLE IF NOT EXISTS public.person
    (
        id bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 9223372036854775807 CACHE 1 ),
        dob integer NOT NULL,
        first_name character varying(255) COLLATE pg_catalog."default",
        last_name character varying(255) COLLATE pg_catalog."default",
        middle_name character varying(255) COLLATE pg_catalog."default",
        CONSTRAINT person_pkey PRIMARY KEY (id)
    )

18. Publisher
    

    CREATE TABLE IF NOT EXISTS public.publisher
    (
        id bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 9223372036854775807 CACHE 1 ),
        publisher_name character varying(255) COLLATE pg_catalog."default",
        CONSTRAINT publisher_pkey PRIMARY KEY (id)
    )

19. Report
    

    CREATE TABLE IF NOT EXISTS public.report
    (
        id bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 9223372036854775807 CACHE 1 ),
        name character varying(255) COLLATE pg_catalog."default",
        report_type character varying(255) COLLATE pg_catalog."default",
        published_by_id bigint NOT NULL,
        report_document_id bigint,
        CONSTRAINT report_pkey PRIMARY KEY (id),
        CONSTRAINT fk6jggto0ge732s1htdbb7neb7p FOREIGN KEY (report_document_id)
        REFERENCES public.document (id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION,
        CONSTRAINT fkqq2fipgfhaqmnpyt2c5ethggl FOREIGN KEY (published_by_id)
        REFERENCES public.publisher (id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
    )
    
20. Search
    
    
    CREATE TABLE IF NOT EXISTS public.search
    (
        member_id character varying(255) COLLATE pg_catalog."default" NOT NULL,
        document_id bigint NOT NULL,
        CONSTRAINT search_pkey PRIMARY KEY (document_id, member_id),
        CONSTRAINT fk41nvqprjtub36qm4mqyyn24yk FOREIGN KEY (member_id)
        REFERENCES public.member (id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION,
        CONSTRAINT fk7mu19ysuocyntiayijrpnu8i5 FOREIGN KEY (document_id)
        REFERENCES public.document (id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
    )
    
21. Thesis

    
    CREATE TABLE IF NOT EXISTS public.thesis
    (
        id bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 9223372036854775807 CACHE 1 ),
        topic character varying(255) COLLATE pg_catalog."default",
        published_by_id bigint NOT NULL,
        thesis_document_id bigint,
        CONSTRAINT thesis_pkey PRIMARY KEY (id),
        CONSTRAINT fkbiljvfda0dgiscwqv5ye48mx6 FOREIGN KEY (published_by_id)
        REFERENCES public.publisher (id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION,
        CONSTRAINT fkgix136rvfkro9ttu7kenviubu FOREIGN KEY (thesis_document_id)
        REFERENCES public.document (id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
    )
    

22. Users    

    
    CREATE TABLE IF NOT EXISTS public.users
    (
        id bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 9223372036854775807 CACHE 1 ),
        address1 character varying(255) COLLATE pg_catalog."default",
        address2 character varying(255) COLLATE pg_catalog."default",
        age integer NOT NULL,
        city character varying(255) COLLATE pg_catalog."default",
        dob integer NOT NULL,
        email_id character varying(255) COLLATE pg_catalog."default",
        first_name character varying(255) COLLATE pg_catalog."default",
        last_name character varying(255) COLLATE pg_catalog."default",
        middle_name character varying(255) COLLATE pg_catalog."default",
        password character varying(255) COLLATE pg_catalog."default",
        phone_number character varying(255) COLLATE pg_catalog."default",
        state character varying(255) COLLATE pg_catalog."default",
        zip_code character varying(255) COLLATE pg_catalog."default",
        CONSTRAINT users_pkey PRIMARY KEY (id)
    )